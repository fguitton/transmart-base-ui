<link rel='stylesheet' href='bower_components/typicons/src/font/typicons.min.css' />

<!--------------------------------------------------------------------------------------------------------------------->
<!-- START Popover template -->
<script type="text/ng-template" id="PopoverTemplate">
  <div>
    <table >
      <tr ng-repeat="(key, value) in metadata" class="popover-table-row">
        <td ><b>{{key}}:&nbsp&nbsp</b></td>
        <td></td>
        <td>{{value}}</td>
      </tr>
    </table>

    <span class="typcn typcn-key"></span>
    <span class="typcn typcn-user"></span>
    <span class="typcn typcn-book"></span>
  </div>
</script>
<!-- END Popover template -->
<!--------------------------------------------------------------------------------------------------------------------->

<!--------------------------------------------------------------------------------------------------------------------->
<!-- START Node template -->
<script type="text/ng-template" id="nodes_renderer.html">
  <div ui-tree-handle
       class="tree-node tree-node-content"
       ng-click="countChilds(node);displayNodeSummaryStatistics(node);"
       popover-template="'PopoverTemplate'"
       popover-placement="right"
       popover-append-to-body="true"
       popover-trigger="mouseenter"
       popover-title="{{node.title}}">
    <a data-nodrag ng-click="toggle(this)">
      <span class="typcn" ng-class="{'typcn-folder': collapsed && type.fol(node),
                                     'typcn-folder-open': !collapsed && type.fol(node),
                                     'typcn-sort-numerically': type.num(node),
                                     'typcn-sort-alphabetically': type.cat(node),
                                     'typcn-chart-bar': type.hid(node)}">
      </span> &nbsp;
    </a>
    {{node.title}} &nbsp; &nbsp; <small>({{node.total}})</small>
  </div>
  <ol ui-tree-nodes="" ng-model="node.nodes" ng-class="{hidden: collapsed}">
    <li ng-repeat="node in node.nodes"
        ui-tree-node
        ng-include="'nodes_renderer.html'"
        data-collapsed="treeConfig.collapsed">
    </li>
  </ol>
</script>
<!--------------------------------------------------------------------------------------------------------------------->
<!-- END Node template -->

<div class="col-sm-3 col-md-2 sidebar" ng-controller="SidebarCtrl">

  <!-- START STUDIES -->
  <accordion close-others="oneAtATime">
    <accordion-group heading=" Highlights" is-open="status.isFirstOpen" is-disabled="status.isFirstDisabled">
      Browse studies by clicking study header below.
    </accordion-group>

    <hr>
    <span><h4>Public studies</h4></span>

    <div ng-repeat="study in publicStudies" ng-controller="StudyCtrl">
      <accordion-group>

        <accordion-heading>
          <div ng-click="getTree(study); getStudyConcepts('{{study._links.self.href}}', '{{study._embedded.ontologyTerm.name}}')"
               popover-template="'PopoverTemplate'"
               popover-placement="right"
               popover-append-to-body="true"
               popover-trigger="mouseenter"
               popover-title="{{study._embedded.ontologyTerm.name}}">
            {{study._embedded.ontologyTerm.name}}
            <i class="glyphicon glyphicon-spin" ng-class="{'glyphicon-refresh': treeLoading}"></i>
          </div>
        </accordion-heading>

        <div ui-tree id="tree-root-public" data-drag-enabled="treeConfig.drag" data-drop-enabled="false">
          <ol ui-tree-nodes="" ng-model="tree.nodes[0].nodes">
            <li ng-repeat="node in tree.nodes[0].nodes" ui-tree-node ng-include="'nodes_renderer.html'" data-collapsed="treeConfig.collapsed"></li>
          </ol>
        </div>

      </accordion-group>
    </div>

    <br>
    <span><h4>Private studies</h4></span>
    <div ng-repeat="study in privateStudies" ng-controller="StudyCtrl">
      <accordion-group>

        <accordion-heading>
          <div ng-click="getTree(study); getStudyConcepts('{{study._links.self.href}}', '{{study._embedded.ontologyTerm.name}}')"
               popover-template="'PopoverTemplate'"
               popover-placement="right"
               popover-append-to-body="true"
               popover-trigger="mouseenter"
               popover-title="{{study._embedded.ontologyTerm.name}}">
            {{study._embedded.ontologyTerm.name}}
            <i class="glyphicon glyphicon-spin" ng-class="{'glyphicon-refresh': treeLoading}"></i>
          </div>
        </accordion-heading>

        <div ui-tree id="tree-root-private" data-drag-enabled="treeConfig.drag">
          <ol ui-tree-nodes="" ng-model="tree.nodes[0].nodes">
            <li ng-repeat="node in tree.nodes[0].nodes" ui-tree-node ng-include="'nodes_renderer.html'"></li>
          </ol>
        </div>


    </accordion-group>
  </div>

    <hr>

    <accordion-group>
      <accordion-heading>
        Configure RESTFul Endpoint
      </accordion-heading>

      <ul>
        <li ng-repeat="endpoint in endpoints"><a href="{{endpoint.url}}" tooltip="{{endpoint.url}}">{{endpoint.title}}</a></li>
      </ul>

      <br>

      <form name="formData.endpointForm" ng-submit="addResource()" role="form">
        <div class="form-group">
          <input type="text" class="form-control input-sm" placeholder="Title" ng-model="formData.title">
        </div>
        <div class="form-group">
          <input type="text" class="form-control input-sm" placeholder="Endpoint url" ng-model="formData.url">
        </div>
        <div class="form-group">
          <button type="button" class="form-control btn btn-default" ng-click="navigateToAuthorizationPage()">Get request token</button>
        </div>
        <div class="form-group">
          <input type="text" class="form-control input-sm" placeholder="Request token" ng-model="formData.requestToken">
        </div>
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Save</button>
        </div>
      </form>
    </accordion-group>
  </accordion>
</div>
  <!--end tree-->
  <br>

</div>
